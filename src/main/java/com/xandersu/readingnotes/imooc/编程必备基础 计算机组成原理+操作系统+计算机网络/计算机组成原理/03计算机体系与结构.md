# 冯诺依曼体系

- 必须有一个存储器

- 必须有一个控制器

- 必须有一个运算器

- 必须有输入设备

- 必须有输出设备

- 能够把需要的程序和数据送至计算机中

- 能够长期记忆程序、数据、中间结果及最终运算结果的能力

- 能够具备算术、逻辑运算和数据传送等数据加工处理的能力

- 能够按要求将处理结果输出给用户


# 计算机总线

## 总线：片内总线、系统总线

片内总线：

- 芯片内部的总线
- 寄存器与寄存器之间
- 寄存器与控制器、运算器之间

系统总线：

- 数据总线

  - 双向传输各个部件的数据信息
  - 数据总线的位数（总线宽度）是数据总线的重要参数

- 地址总线

  - 指定源数据或目的数据在内存中的地址
  - 地址总线得我位数与存储单元有关

- 控制总线

  - 控制总线是用来发出各种控制信号的传输线
  - 控制信号经由控制总线从一个组件发给另一个组件
  - 控制总线可以监视不同组件之间的状态（就绪/未就绪）

  

## 总线的仲裁：为了解决总线使用权的冲突问题

仲裁方法：

- 链式查询
  - 好处：电路复杂度低，仲裁方式简单
  - 坏处：优先级低的设备难以获得总线使用权
  - 坏处：对电路故障敏感
- 计时器定时查询
  - 仲裁控制器对设备编号并使用计数器累计计数
  - 接收到仲裁信号后，往所有设备发出计数值
  - 计数值与设备编号一致则获得总线使用权
- 独立请求
  - 每个设备均有总线独立连接仲裁器
  - 设备可单独向仲裁器发送请求和接收请求
  - 当同时收到多个请求信号，仲裁器有权按优先级分配使用权
  - 好处：响应速度快，优先顺序可以动态改变
  - 设备连线多，总线控制复杂

# 计算机输入输出设备

## 输入输出接口通用设计

- 数据线
  - 是IO设备与主机之间进行数据交换的传输线
  - 单向传输
  - 双向传输
- 状态线
  - IO设备状态向主机报告的信号线
  - 查询设备是否正常连接并且就绪
  - 查询设备是否已经被占用
- 命令线
  - CPU向设备发送命令的信号线
  - 发送读写命令
  - 发送启动停止信号
- 设备选择线
  - 主机选择IO设备进行操作的信号线
  - 对连在总线上的设备进行选择

## CPU与IO设备的通信

- 程序中断
  - 当外围IO设备就绪时，向CPU发送中断信号
  - CPU有专门的电路响应中断信号
  - 提供低速设备通知CPU的一种异步的方式
  - CPU可以高速运转的同时兼顾低速设备的响应
- DMA（直接存储器访问）
  - DMA直接连接主存与IO设备
  - DMA工作时不需要CPU参与
  - 当主存与IO设备交换信息时，不需要中断CPU
  - 提高CPU效率，不需要频繁中断
  - 硬盘、显卡里都有

# 计算机存储器

存储器分类：

存储介质：半导体存储器、磁存储器

存取方式：随机存储器RAM、串行存储器、只读存储器ROM

局部性原理：CPU访问存储器时，无论存储指令和存储数据，所访问的存储单元趋于聚集在一个较小的连续区域中。



# 主存储器和辅助存储器

主存储器——内存

- RAM随机存储器
- RAM通过电容存储数据，必须隔一段时间刷新一次
- 掉电，丢失数据集

辅助存储器——磁盘

- 表面是可磁化的硬磁性材料
- 移动磁头径向运动读取磁道信息
- 先来先服务算法
  - 按顺序访问进程的磁道读写需求
- 最短寻道时间优先算法
  - 与磁头当前位置有关
  - 优先访问离磁头最近的磁道
- 扫描算法（电梯算法）
  - 每次只往一个方向移动
  - 到达一个方向需要服务的尽头再反方向移动
- 循环扫描算法


# 计算机高速缓存

解决CPU与主存速度不匹配的问题

## 高速缓存工作原理

字：指存放在一个存储单元中的二进制代码组合

- 字的地址包含两个部分
- 前m位指定字块的地址
- 后b位指定字在字块中的地址

字块：存储在连续的存储单元中而被看做是一个单元的一组字

## 高速缓存的替换策略

- 随机算法
- 先进先出算法FIFO
- 最不经常使用算法LFU
- 最近最少使用算法LRU

# 计算机指令系统

机器指令的形式：

- 机器指令主要由两部分组成：操作码、地址码
  - 操作码指明指令所要完成的操作
  - 操作码的位数反应了机器的操作种类
  - 地址码直接给出操作数或者操作数地址
  - 分三地址码指令、二地址码指令和一地址码指令
    - OP addr1 addr2 addr3 : (addr1)OP(addr2)->(addr3)
    - OP addr1 addr2  :  (addr1)OP(addr2)->(addr1)或者(addr2)
    - OP addr1  : (addr1)OP->(addr1)   或者   (addr1)OP(ACC)->(addr1)
  - 零地址指令：在机器指令中无地址码：空操作、停机操作、中断返回操作等

机器指令的操作类型：

- 数据传输
  - 寄存器之间、寄存器与存储单元、存储单元之间传送
  - 数据读写、交换地址数据、清零置一等操作

- 算术逻辑操作
  - 操作数之间加减乘除运算
  - 操作数的与或非等逻辑位运算
- 移位操作
  - 数据左移（乘2）、数据右移（除2）
  - 完成数据在算术逻辑单元的必要操作
- 控制指令
  - 等待指令、停机指令、空操作指令、中断指令等

## 机器指令的寻址方式

指令寻址

- 顺序寻址
- 跳跃寻址

数据寻址

- 立即寻址
  - 指令直接获得操作数
  - 无需访问存储器
- 直接寻址
  - 直接给出操作数在主存的地址
  - 寻找操作数简单，无需计算数据地址
- 间接寻址
  - 指令地址码给出的是操作数地址的地址
  - 访问一次或者多次主存来获取操作数

# 计算机控制器

控制器是协调和控制计算机运行的

- 程序计数器
  - 存储下一条指令的地址
  - 循环从程序计数器中拿出指令
  - 指令被拿出时，指向下一条指令
- 时序发生器
  - 电气工程领域、发送时序脉冲
  - CPU依据不同的时序脉冲有节奏的进行工作
- 指令译码器
  - 指令译码器是控制器主要部件之一
  - 计算机指令由操作码和地址码组成
  - 翻译操作码对应的操作以及控制传输地址码对应的数据
- 各种寄存器
  - 指令寄存器
    - 指令寄存器也是控制器的主要部件之一 
    - 从主存或高速缓存取计算机指令 
  - 主存地址寄存器
    - 保存当前CPU正要访问的内存单元的地址 
  - 主存数据寄存器
    - 保存当前CPU正要读或写的主存数据 
  - 通用寄存器
    - 用于暂时存放或传送数据或指令 
    - 可保存ALU的运算中间结果
    - 容量比一般专用寄存器要大 

# **计算机的运算器** 

运算器是用来进行数据运算加工的

- 数据缓冲器 
  - 分为输入缓冲和输出缓冲
  - 输入缓冲暂时存放外设送过来的数据 
  - 输出缓冲暂时存放送往外设的数据 
- ALU
  - ALU:算术逻辑单元，是运算器的主要组成 
  - 常见的位运算(左右移、与或非等)
  - 算术运算(加减乘除等) 
- 状态字寄存器
  - 存放运算状态(条件码、进位、溢出、结果正负等) 
  - 存放运算控制信息(调试跟踪标记位、允许中断位等) 
- 通用寄存器 
  - 用于暂时存放或传送数据或指令 
  - 可保存ALU的运算中间结果
  - 容量比一般专用寄存器要大 

# 计算机指令的执行过程

**指令执行过程** 

1. 取指令

   1. 从缓存取指令
   2. 送到指令寄存器

2. 分析指令

   1. 指令译码器译码
   2. 发出控制信号
   3. 程序计数器+1 

3. 执行指令

   1. 装载数据到寄存器 

   2. ALU处理数据 

   3. 记录运算状态
   4. 送出运算结果

**CPU的综合利用率并不高** 

**CPU的流水线设计** 

- 类似工厂的装配线
- 工厂的装配线使得多个产品可以同时被加工
- 在同一个时刻，不同产品均位于不同的加工阶段 

# 计算机的异构计算设备 

**图像处理器(GPU)** 

- 又称显示核心、视觉处理器、显示芯片 
- 擅长执行复杂的数学和几何计算 

**现场可编程门阵列(FPGA)** 

- 是一种专用集成电路，诞生于1985年
- 电路级别的设备，属于硬件层面的开发
- AI人工智能的大热，FPGA逐渐走进大众的视野 
- AI的大规模参数训练
- 音视频、图像处理等复杂计算 









































