# 7-01 垃圾回收之标记算法

# 垃圾回收

垃圾回收最终归结为自动化的解决里两个问题

1. 对象内存分配
2. 回收分配给对象的内存

## 对象被判断定为垃圾的标准

- 没有被其他对象引用，占据的内存要被jvm释放

## 判断是否为垃圾的方法

- 引用计数

- 可达性分析 

## 判断对象的引用数量

- 对象引用数量

- 引用计数器，被引用+1，完成引用-1
- 引用计数为0的当做是垃圾

### 优缺点

- 优点：执行效率高，程序影响小

- 缺点：无法检测循环引用，导致内存泄漏

## 可达性算法

### 通过判断对象的引用链是否可达来决定对象是否可以被回收

根据图论引用的，程序把所有的引用关系看做一张图，通过一系列的名为GC Roots的对象作为起始点，从这些节点开始向下搜索，搜索所走过的路径被称为引用链即refrence chain，当一个对象从一个GC Roots没有任何引用链相连，从图论上说从GC Roots到该对象是不可达的，这个时候证明是对象时垃圾对象。

图计算

判断对象的引用链是否可达

### 可以作为GC Root的对象

- 虚拟机栈中的引用对象（栈帧中的本地变量表）
  - 在方法里new Object并赋值给了一个局部变量，在该局部变量没有被销毁之前，new出的这个Object就会称为GC Roots
- 方法区中的常量引用的对象
  - 类里定义的常量，这个常量保存的是某个对象的地址，被保存的对象称为GC的根对象
- 方法区中的类静态属性引用的对象
- 本地方法栈中JNI（native方法）的引用对象
  - 非Java语言构建的对象
- 活跃线程的引用对象





